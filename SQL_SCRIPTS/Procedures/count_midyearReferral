DROP PROCEDURE IF EXISTS count_midyearReferral;
DELIMITER $$
CREATE PROCEDURE count_midyearReferral()
BEGIN 
SELECT D.Department,Count(T.Referral) AS "Number of Referrals"
 from patient AS P
 INNER JOIN treatment AS T
 INNER JOIN department AS D
 WHERE P.uid=T.uid &&
 P.Department_ID=D.Department_id &&
 T.TreatmentDate BETWEEN CONCAT(YEAR(NOW()),"-01-01") AND CONCAT(YEAR(NOW()),"-07-31")
  GROUP BY T.Referral;
 END$$
 DELIMITER ;
